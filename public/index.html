<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="kdarts.css" rel="stylesheet" type="text/css" />
<script src="https://code.jquery.com/jquery-2.1.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="darts.js"></script>
<script type="text/javascript" src="dpd.js"></script>
<script src="outchart.js"></script>
<meta charset="utf-8">
<title>KDarts - The Darts game manager</title>
</head>

<body>

  <div class="container">

    <div class="row navbar">
      <header>
        <div class="col-md-12 js_welcome-navbar">
          <h1>Kdarts <small>The Darts game manager</small>
            <span class="pull-right">
              <small><a class="btn btn-default" href="#">About</a></small>
            </span>
          </h1>
        </div>

        <div class="col-md-12 js_x01-navbar" style="display: none">
          <span class="game-info left">Darts X01</span>
          <span class="pull-right js_timer">00:00</span>
        </div>

        <div class="col-md-12 winner-navbar js_winner-navbar" style="display: none">
          <div>
            <span class="glyphicon glyphicon-star"></span>
            <span class="name label label-success">Laci won</span>
            <span class="glyphicon glyphicon-star"></span>
          </div>
          <div>
            <a href="#" id="playagain" class="btn btn-primary">Play again</a>
            <a href="#" id="closeplay" class="btn btn-primary">Back to menu</a>
          </div>
        </div>
      </header>
    </div>


    <div class="row manager">
      <div class="col-md-4 col-md-offset-4">
        <div class="well well-lg game-options">
          <div class="player-count">
            <h2>Players</h2>
            <div class="btn-toolbar" role="toolbar">
              <div class="btn-group">
                <button id="playerCount2" type="button" class="btn btn-default active player-count-btn" data-id="2">2</button>
                <button id="playerCount3" type="button" class="btn btn-default player-count-btn" data-id="3">3</button>
                <button id="playerCount4" type="button" class="btn btn-default player-count-btn" data-id="4">4</button>
              </div>
              <a href="#" class="player-name-editor-btn"><span class="pull-right glyphicon glyphicon-wrench"></span></a>
            </div>

            <div class="player-name-editor">
              <div class="form-group">
                <input type="text" value="Player1" class="form-control player-name-1" placeholder="player1">
              </div>
              <div class="form-group">
                <input type="text" value="Player2" class="form-control player-name-2" placeholder="player2">
              </div>
              <div class="form-group">
                <input type="text" value="Player3" class="form-control player-name-3" placeholder="player3">
              </div>
              <div class="form-group">
                <input type="text" value="Player4" class="form-control player-name-4" placeholder="player4">
              </div>
            </div>

          </div>

          <div class="player-count">
            <h2>Game</h2>
            <div class="btn-toolbar" role="toolbar">
              <div class="btn-group">
                <button id="gameType301" type="button" class="btn btn-default active game-type-btn" data-id="301">301</button>
                <button id="gameType501" type="button" class="btn btn-default game-type-btn" data-id="501">501</button>
                <button id="gameType1001" type="button" class="btn btn-default game-type-btn" data-id="1001">1001</button>
              </div>
            </div>
          </div>

          <div class=" clearfix">
            <span class="pull-right">
              <button id="startgame" type="button" class="btn btn-primary"><span class="glyphicon glyphicon-ok"></span> start</button>
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="row game">

      <!-- X01 DARTS GAME TEMPLATE -->
      <div class="col-xs-12 col-sm-6 col-md-6 x01-darts-tml">
        <div class="well">
          <section class="player-number">
            <div class="clearfix">
              <h4 class="player-name">Randall</h4>
              <span class="current-points pull-right">301</span>
            </div>
            <form class="">
              <div class="form-group points-editor-container">
                <div class="input-group">
                  <input type="text" class="form-control point-editor" placeholder="Enter points">
                  <span class="input-group-addon gen-points"></span>
                  <a class="save btn btn-success pull-right">Save</a>
                </div>
              </div>
            </form>
            
            <div class="point-lists-stats">
              <div class="status clearfix">
                <span class="avg-label pull-left clearfix">avg</span>
                <span class="avg pull-left clearfix"></span>
                <span class="hidden remaining-points pull-right clearfix"></span>
                <span class="hidden remaining-label pull-right clearfix">rem</span>
                <span class="out-suggestions pull-right"></span>
              </div>

              <div class="hidden shot-list"></div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <div class="keyboard">
    <div class="wrapper">
      <span class="button" data-key="t">Treble</span>
      <span class="button" data-key="1">1</span>
      <span class="button" data-key="2">2</span>
      <span class="button" data-key="3">3</span>
      <span class="button" data-key="d">Double</span>
      <span class="button" data-key="4">4</span>
      <span class="button" data-key="5">5</span>
      <span class="button" data-key="6">6</span>
      <span class="button" data-key=" ">⌙</span>
      <span class="button" data-key="7">7</span>
      <span class="button" data-key="8">8</span>
      <span class="button" data-key="9">9</span>
      <span class="button" data-key="delete">←</span>
      <span class="button" data-key="b">Bull</span>
      <span class="button" data-key="0">0</span>
      <span class="button" data-key="db">DBull</span>
    </wrapper>
  </div>


<script src="dartsmanager.js"></script>
<script src="usermanager.js"></script>
<script>
// default playercount and game type
var playerCount = 2;
var gameType = 301;

// event handler for player count
var playerCountClicked = function(event) {
  $('#playerCount2').removeClass('active');
  $('#playerCount3').removeClass('active');
  $('#playerCount4').removeClass('active');
  playerCount = Number($(this).attr('data-id'));
  $(this).addClass('active');
  for(var i = 1; i <= 4; i++) {
    if (i <= playerCount)
      $('.player-name-' + i).show();
    else
      $('.player-name-' + i).hide();
  }
};

// event handler for game type selector
var gameTypeClicked = function(event) {
  $('#gameType301').removeClass('active');
  $('#gameType501').removeClass('active');
  $('#gameType1001').removeClass('active');
  gameType = Number($(this).attr('data-id'));
  $(this).addClass('active');
};

// initialize event handlers and the game
$('.game-type-btn').click(gameTypeClicked);
$('.player-count-btn').click(playerCountClicked);
$('.player-name-editor-btn').click(function () {
  if ($('.player-name-editor:visible').length === 0)
    $('.player-name-editor').show(200); 
  else
    $('.player-name-editor').hide(200); 
})

$('#startgame').click(function(evt) {
  $('.row.manager').hide(250);
  $('.row.game').show(350);
  dartsManager.create(playerCount, gameType);
});


function randomNames() {
  var nameHell = ['Randall', 'Kugli', 'Bumi', 'Plaplap', 'Uxi', 'Saxi', 'Jockey', 'Ubul', 'Lukas'];
  var res = [];
  while (res.length < 4) {
    var cut = Math.ceil( Math.random() * nameHell.length - 1);
    res.push(nameHell[cut]);
    nameHell = nameHell.slice(0, cut).concat(nameHell.slice(cut + 1));
  }
  return res;
}

var names = randomNames();
$('.player-name-1').val(names[0]);
$('.player-name-2').val(names[1]);
$('.player-name-3').val(names[2]);
$('.player-name-4').val(names[3]);

window.onbeforeunload = function(event) {
  if (dartsManager.inGame) {
    return confirm("Are you sure you want to leave this game?");  
  }
};

</script>
</body>
</html>
